<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salih Tekin AyvacÄ± | Portfolyo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    
    <script src="avrgirl-arduino.global.js"></script>
</head>
<body>

    <nav class="sidebar">
        <div class="profile-img-container">
            <img src="https://github.com/SalihAyvaci21.png" alt="Profile" class="profile-img">
        </div>
        <div class="name">Salih Tekin AyvacÄ±</div>
        <div class="title">GÃ¶mÃ¼lÃ¼ Sistemler & FPGA</div>

        <div class="nav-menu">
            <div class="nav-btn active" onclick="showSection('about', this)"><i class="fas fa-user-astronaut"></i> HakkÄ±mda</div>
            <div class="nav-btn" onclick="showSection('projects', this)"><i class="fas fa-code-branch"></i> Projelerim</div>
            <div class="nav-btn" onclick="showSection('games', this)"><i class="fas fa-gamepad"></i> Oyun AlanÄ±</div>
            <div class="nav-btn" onclick="showSection('iot', this)"><i class="fas fa-robot"></i> Robotik Lab</div>
        </div>

        <div class="social-links">
            <a href="https://github.com/SalihAyvaci21" target="_blank" class="social-icon"><i class="fab fa-github"></i></a>
            <a href="https://linkedin.com/in/salih-tekin-ayvaci" target="_blank" class="social-icon"><i class="fab fa-linkedin-in"></i></a>
        </div>
    </nav>

    <main class="main-content">
        
        <section id="about" class="active">
            <h1>Merhaba, Ben Salih ðŸ‘‹</h1>
            <p>Elektronik ve yazÄ±lÄ±m dÃ¼nyasÄ±nda sÄ±nÄ±rlarÄ± zorlamayÄ± seven bir geliÅŸtiriciyim. Ã–zellikle <strong>FPGA</strong>, <strong>Mikrodenetleyiciler</strong> ve <strong>SensÃ¶r EntegrasyonlarÄ±</strong> Ã¼zerine Ã§alÄ±ÅŸÄ±yorum.</p>
            
            <h2>ðŸ›  Yeteneklerim</h2>
            <div class="grid">
                <div class="card">
                    <h3>YazÄ±lÄ±m & Oyun</h3>
                    <div style="margin-top:15px;">
                        <div class="skill-bar"><div class="skill-info"><span>C / C++ (Embedded)</span><span>90%</span></div><div class="progress-bg"><div class="progress" style="width: 90%"></div></div></div>
                        <div class="skill-bar"><div class="skill-info"><span>Verilog / VHDL</span><span>75%</span></div><div class="progress-bg"><div class="progress" style="width: 75%"></div></div></div>
                        <div class="skill-bar"><div class="skill-info"><span>Lua / Unity</span><span>60%</span></div><div class="progress-bg"><div class="progress" style="width: 60%"></div></div></div>
                    </div>
                </div>
                <div class="card">
                    <h3>DonanÄ±m & Kartlar</h3>
                    <div class="tech-stack" style="margin-top:15px;">
                        <span class="tech-tag">Tang Nano 9K</span>
                        <span class="tech-tag">Gatemate CCGM1A1</span>
                        <span class="tech-tag">STM32</span>
                        <span class="tech-tag">RPi Pico</span>
                        <span class="tech-tag">Arduino Uno</span>
                        <span class="tech-tag">ESP32</span>
                    </div>
                </div>
            </div>
        </section>

        <section id="projects">
            <h1>TÃ¼m Projelerim</h1>
            <div id="repos-container" class="grid">
                <div class="loading-text">GitHub'dan veriler Ã§ekiliyor...</div>
            </div>
        </section>

        <section id="games">
            <h1>Mini Arcade</h1>
            <div class="game-container-split">
                <div class="game-list">
                    <div class="card game-card" onclick="startGame('snake', this)">
                        <h3><i class="fas fa-worm"></i> Cyber Snake</h3>
                    </div>
                    <div class="card game-card" onclick="startGame('tetris', this)">
                        <h3><i class="fas fa-cubes"></i> Neon Blocks</h3>
                    </div>
                    <div class="card game-card" onclick="startGame('maze', this)">
                        <h3><i class="fas fa-ghost"></i> Maze Chase</h3>
                    </div>
                </div>
                <div class="game-stage">
                    <div id="scoreBoard" class="score-board">SKOR: 0</div>
                    <canvas id="gameCanvas" width="400" height="400"></canvas>
                    <div id="gameControls" class="game-controls">Oynamak iÃ§in bir oyun seÃ§in</div>
                </div>
            </div>
        </section>

        <section id="iot">
            <h1>ðŸ¤– Robotik Kodlama LaboratuvarÄ±</h1>
            <p>Ä°ster C++ kodu yazÄ±p yÃ¼kleyin, ister bloklarla kontrol edin.</p>
            
            <div class="card" style="border-top: 4px solid #00bcd4; margin-bottom: 20px;">
                <div class="card-header" style="border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 10px;">
                    <h3><i class="fas fa-code"></i> C++ Kod EditÃ¶rÃ¼</h3>
                </div>

                <div style="position: relative;">
                    <textarea id="cppEditor" style="width: 100%; height: 200px; background: #111; color: #0f0; border: 1px solid #444; padding: 10px; font-family: 'Consolas', monospace; border-radius: 4px; resize: vertical;">
void setup() {
  pinMode(13, OUTPUT);
}

void loop() {
  digitalWrite(13, HIGH);
  delay(100);
  digitalWrite(13, LOW);
  delay(100);
}
                    </textarea>
                    <div id="statusLabelNew" style="margin-top: 5px; font-size: 0.9rem; color: #888;">Durum: Bekleniyor...</div>
                </div>

                <div class="header-controls" style="justify-content: flex-start; margin-top: 15px;">
                    <button id="btnCompileNew" class="serial-btn" style="background:#00bcd4; color:black;" onclick="runCompiler()">
                        <i class="fas fa-cog"></i> 1. Derle (Server)
                    </button>
                    
                    <button id="btnUploadNew" class="serial-btn off" style="background:#555; color:white; cursor: not-allowed;" disabled onclick="runUploader()">
                        <i class="fas fa-upload"></i> 2. Kodu YÃ¼kle
                    </button>
                </div>
            </div>

            <div class="card" style="border-top: 4px solid var(--primary);">
                <div class="card-header" style="border-bottom: 1px solid #333; padding-bottom: 15px; margin-bottom: 0;">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <h3><i class="fas fa-cubes"></i> Blok StÃ¼dyosu & Kontrol</h3>
                        <span id="statusBadge" class="status-badge"><i class="fas fa-circle" style="font-size:0.6rem;"></i> BaÄŸlantÄ± Yok</span>
                    </div>
                    
                    <div class="header-controls">
                        <button id="btnQuickTest" class="serial-btn" style="background:#7000ff; color:white;" onclick="runQuickTest()">
                            <i class="fas fa-microchip"></i> Test Firmware YÃ¼kle
                        </button>
                        
                        <button id="btnConnect" class="serial-btn connect" onclick="connectSerial()">
                            <i class="fas fa-plug"></i> BaÄŸlan (Bloklar Ä°Ã§in)
                        </button>
                        <button id="btnDisconnect" class="serial-btn off" onclick="disconnectSerial()" style="display:none; background:#ff0055; color:white;">
                            <i class="fas fa-power-off"></i> Kes
                        </button>
                    </div>
                </div>

                <div class="iot-panel">
                    
                    <div class="block-list">
                        <div class="code-block" style="background: linear-gradient(90deg, #4C97FF, #2D7DE0);">
                            <i class="fas fa-lightbulb"></i>
                            <span>Pin</span>
                            <select id="pinSelectOn" class="block-input"><option value="13">13</option><option value="12">12</option><option value="11">11</option></select>
                            <span>LED'ini</span> <strong>YAK</strong>
                            <button class="run-btn" onclick="runBlock('ON')"><i class="fas fa-play"></i></button>
                        </div>

                        <div class="code-block" style="background: linear-gradient(90deg, #FF6680, #E02D4C);">
                            <i class="far fa-lightbulb"></i>
                            <span>Pin</span>
                            <select id="pinSelectOff" class="block-input"><option value="13">13</option><option value="12">12</option><option value="11">11</option></select>
                            <span>LED'ini</span> <strong>SÃ–NDÃœR</strong>
                            <button class="run-btn" onclick="runBlock('OFF')"><i class="fas fa-play"></i></button>
                        </div>
                    </div>

                    <div class="console-wrapper">
                        <div class="console-header"><span><i class="fas fa-terminal"></i> Seri Port Konsolu</span><span style="font-size:0.7rem; opacity:0.7;">115200 Baud</span></div>
                        <div id="serialConsole" class="serial-console">
                            > Sistem hazÄ±r.<br>> Kod yazÄ±p yÃ¼kleyebilir veya "BaÄŸlan" diyerek bloklarÄ± kullanabilirsiniz.
                        </div>
                    </div>

                </div>
            </div>
        </section>

    </main>
    
    <script src="script.js"></script>

    <script>
    // --- GLOBAL DEÄžÄ°ÅžKENLER ---
    let compiledHexCode = null; // Derlenen kod
    let serialPort = null;      // AÃ§Ä±k port
    let serialWriter = null;    // Veri gÃ¶nderme aracÄ±

    // ============================================================
    // 1. BÃ–LÃœM: DERLEME VE YÃœKLEME (Backend)
    // ============================================================
    async function compileCode() {
        const editorVal = document.getElementById('cppEditor').value;
        const statusLbl = document.getElementById('statusLabelNew');
        const btnUpload = document.getElementById('btnUploadNew');

        statusLbl.innerText = "Durum: Sunucuda derleniyor... (Bekleyin)";
        statusLbl.style.color = "#40c4ff";

        try {
            const response = await fetch('https://arduino-backend-ajkr.onrender.com/compile', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ code: editorVal })
            });

            if (!response.ok) throw new Error("Sunucu HatasÄ±");
            const data = await response.json();

            if (data.hex) {
                compiledHexCode = data.hex;
                statusLbl.innerText = "Durum: BAÅžARILI! Kodu yÃ¼kleyebilirsiniz.";
                statusLbl.style.color = "#00e676";
                btnUpload.disabled = false;
                btnUpload.style.background = "#ff9800";
                btnUpload.style.cursor = "pointer";
                btnUpload.classList.remove('off');
            } else {
                throw new Error("Hex kodu boÅŸ dÃ¶ndÃ¼.");
            }
        } catch (err) {
            console.error(err);
            statusLbl.innerText = "Hata: " + err.message;
            statusLbl.style.color = "#ff5252";
        }
    }

    async function runUploader(hexDataToUse = null) {
        // EÄŸer fonksiyona Ã¶zel hex verilmediyse, derlenmiÅŸ olanÄ± kullan
        const hexToFlash = hexDataToUse || compiledHexCode;

        if (!hexToFlash) {
            alert("Ã–nce kodu derlemelisiniz!");
            return;
        }
        
        // EÄŸer port aÃ§Ä±ksa kapatmayÄ± dene (Ã‡akÄ±ÅŸmayÄ± Ã¶nlemek iÃ§in)
        if (serialPort) {
            try { await serialPort.close(); serialPort = null; } catch(e){}
        }

        const statusLbl = document.getElementById('statusLabelNew') || document.getElementById('statusBadge');
        if(statusLbl) statusLbl.innerText = "Port SeÃ§iliyor...";

        try {
            await navigator.serial.requestPort(); // Port izni iste
            
            const blob = new Blob([hexToFlash], { type: 'application/octet-stream' });
            const reader = new FileReader();

            reader.onload = function(event) {
                const fileBuffer = event.target.result;
                const avrgirl = new AvrgirlArduino({ board: 'uno', debug: true });

                avrgirl.flash(fileBuffer, (error) => {
                    if (error) {
                        alert("YÃ¼kleme HatasÄ±: " + error.message);
                    } else {
                        alert("BAÅžARILI! Kod YÃ¼klendi. Åžimdi 'BaÄŸlan' diyip kontrol edebilirsiniz.");
                        // YÃ¼kleme bitince statusu gÃ¼ncelle
                        const badge = document.getElementById('statusBadge');
                        if(badge) badge.innerHTML = '<i class="fas fa-check"></i> YÃ¼klendi';
                    }
                });
            };
            reader.readAsArrayBuffer(blob);
        } catch (err) {
            alert("Ä°ÅŸlem Ä°ptal Edildi: " + err);
        }
    }

    // ============================================================
    // 2. BÃ–LÃœM: SERÄ° PORT BAÄžLANTISI VE KONTROL (CanlÄ± EtkileÅŸim)
    // ============================================================
    
    async function connectSerial() {
        if (!navigator.serial) {
            alert("TarayÄ±cÄ±nÄ±z Seri Port desteklemiyor. Chrome veya Edge kullanÄ±n.");
            return;
        }

        try {
            // 1. Port Ä°ste
            serialPort = await navigator.serial.requestPort();
            
            // 2. Portu AÃ§ (Arduino standart hÄ±zÄ± 115200 veya 9600 olabilir, biz 115200 kullanacaÄŸÄ±z)
            await serialPort.open({ baudRate: 115200 });

            // 3. YazÄ±cÄ±yÄ± (Writer) HazÄ±rla
            const textEncoder = new TextEncoderStream();
            const writableStreamClosed = textEncoder.readable.pipeTo(serialPort.writable);
            serialWriter = textEncoder.writable.getWriter();

            // 4. ArayÃ¼zÃ¼ GÃ¼ncelle
            const badge = document.getElementById('statusBadge');
            badge.innerHTML = '<i class="fas fa-circle" style="color:#00e676; font-size:0.6rem;"></i> BaÄŸlandÄ±';
            badge.style.color = "#00e676";
            
            // Konsola yaz
            document.getElementById('serialConsole').innerHTML += "<br>> <span style='color:#0f0'>BaÄŸlantÄ± BaÅŸarÄ±lÄ±!</span> ButonlarÄ± kullanabilirsiniz.";

        } catch (err) {
            console.error(err);
            alert("BaÄŸlantÄ± HatasÄ±: " + err);
        }
    }

    // Butonlara basÄ±lÄ±nca Ã§alÄ±ÅŸan fonksiyon
    async function runBlock(command) {
        if (!serialWriter) {
            alert("Ã–nce 'BaÄŸlan' butonuna basarak baÄŸlantÄ±yÄ± kurmalÄ±sÄ±nÄ±z!");
            return;
        }

        try {
            // Arduino'ya tek karakterlik komut gÃ¶nderiyoruz
            // '1' -> Yak
            // '0' -> SÃ¶ndÃ¼r
            // 'b' -> Blink
            let charToSend = "";
            
            if (command === 'ON') charToSend = "1";
            if (command === 'OFF') charToSend = "0";
            
            await serialWriter.write(charToSend);
            
            // Konsola Log DÃ¼ÅŸ
            document.getElementById('serialConsole').innerHTML += `<br>> Komut GÃ¶nderildi: ${command}`;
            
        } catch (err) {
            alert("GÃ¶nderme HatasÄ±: " + err);
        }
    }

    // ============================================================
    // 3. BÃ–LÃœM: AKILLI FIRMWARE (Serial Dinleyen Kod)
    // ============================================================
    // Bu C++ kodu aÅŸaÄŸÄ±dadÄ±r: 
    /*
        void setup() { 
            pinMode(13, OUTPUT); 
            Serial.begin(115200); 
        }
        void loop() { 
            if(Serial.available()){ 
                char c = Serial.read(); 
                if(c == '1') digitalWrite(13, HIGH); 
                if(c == '0') digitalWrite(13, LOW); 
            } 
        }
    */
    // Bu kodun derlenmiÅŸ HEX hali (Arduino Uno iÃ§in):
    const smartFirmwareHex = [
        ":100000000C9434000C943E000C943E000C943E0082",
        ":100010000C943E000C943E000C943E000C943E0070",
        ":100020000C943E000C943E000C943E000C943E0060",
        ":100030000C943E000C943E000C943E000C943E0050",
        ":100040000C9483000C943E000C943E000C943E00FC",
        ":100050000C943E000C943E000C943E000C943E0030",
        ":100060000C943E000C943E00000000002400270001",
        ":100070002A0000000000250028002B0004040404CE",
        ":100080000404040402020202020203030303030342",
        ":10009000010204081020408001020408102001021F",
        ":1000A00004081020000000080002010000030407FB",
        ":1000B000000000000000000011241FBECFEFD8E0B8",
        ":1000C000DEBFCDBF21E0A0E0B1E001C01D92A930AC",
        ":1000D000B207E1F70E942D010C945E010C940000E0",
        ":1000E0000E9452000E94A700089580910001811197",
        ":1000F00002C01495809300010895E0910001F0E05E",
        ":10010000EE0FFF1FA591B4912FB7F894819191919E",
        ":100110009F012FBF08959091C00095FFFCCF8091EE",
        ":10012000C6008F778093C6001092C10080E1809310",
        ":10013000C4001092C5008093C2000E9470000895E9",
        ":1001400080E090E008950E94720080E00E94770020",
        ":1001500008950E949300611108C08981813311F0D3",
        ":10016000803321F084E00E9477000CC0803331F07E",
        ":1001700080E00E94770004C01092050180930401CA",
        ":100180000895089526E8230F0296A11DB11DD2CF4D",
        ":1001900084B58F7784BD8091B0008F7D8093B0002E",
        ":1001A0001092C100209180002F7D209380008091AC",
        ":1001B000B0008F7D8093B000809180008F77809375",
        ":1001C0008000909101019F5F9F739093010185B5AC",
        ":1001D0008F7785BD909101019F5F9F739093010109",
        ":1001E000209180002F77209380008091B0008F7728",
        ":1001F0008093B000809102018F5F8F738093020125",
        ":1002000085B58F7D85BD809102018F5F8F738093E2",
        ":1002100002010895982F8091C00085FFFCCF9093FA",
        ":10022000C6000895EF92FF920F931F93CF93DF930D",
        ":10023000809102018F5F8F738093020185B58F7D3D",
        ":1002400085BD809102018F5F8F738093020120914E",
        ":1002500080002F77209380008091B0008F778093B1",
        ":10026000B000809101018F5F8F738093010185B512",
        ":100270008F7785BD809101018F5F8F738093010190",
        ":100280001092C100209180002F7D20938000809103",
        ":10029000B0008F7D8093B000DF91CF911F910F91DB",
        ":1002A000FF90EF900895F894FFCF3600000000005C",
        ":00000001FF"
    ].join('\n').trim();

    function uploadDefaultBlink() {
        // "Firmware YÃ¼kle" butonuna basÄ±nca bu Ã§alÄ±ÅŸacak
        // Bu kod, serial komutlarÄ± dinleyen Ã¶zel koddur.
        runUploader(smartFirmwareHex);
    }
</script>
</body>
</html>







