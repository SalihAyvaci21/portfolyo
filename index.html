<!DOCTYPE html>

<html lang="tr">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Salih Tekin AyvacÄ± | Portfolyo</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="style.css">

    

    <script src="avrgirl-arduino.global.js"></script>

</head>

<body>



    <nav class="sidebar">

        <div class="profile-img-container">

            <img src="https://github.com/SalihAyvaci21.png" alt="Profile" class="profile-img">

        </div>

        <div class="name">Salih Tekin AyvacÄ±</div>

        <div class="title">GÃ¶mÃ¼lÃ¼ Sistemler & FPGA</div>



        <div class="nav-menu">

            <div class="nav-btn active" onclick="showSection('about', this)"><i class="fas fa-user-astronaut"></i> HakkÄ±mda</div>

            <div class="nav-btn" onclick="showSection('projects', this)"><i class="fas fa-code-branch"></i> Projelerim</div>

            <div class="nav-btn" onclick="showSection('games', this)"><i class="fas fa-gamepad"></i> Oyun AlanÄ±</div>

            <div class="nav-btn" onclick="showSection('iot', this)"><i class="fas fa-robot"></i> Robotik Lab</div>

        </div>



        <div class="social-links">

            <a href="https://github.com/SalihAyvaci21" target="_blank" class="social-icon"><i class="fab fa-github"></i></a>

            <a href="https://linkedin.com/in/salih-tekin-ayvaci" target="_blank" class="social-icon"><i class="fab fa-linkedin-in"></i></a>

        </div>

    </nav>



    <main class="main-content">

        

        <section id="about" class="active">

            <h1>Merhaba, Ben Salih ðŸ‘‹</h1>

            <p>Elektronik ve yazÄ±lÄ±m dÃ¼nyasÄ±nda sÄ±nÄ±rlarÄ± zorlamayÄ± seven bir geliÅŸtiriciyim. Ã–zellikle <strong>FPGA</strong>, <strong>Mikrodenetleyiciler</strong> ve <strong>SensÃ¶r EntegrasyonlarÄ±</strong> Ã¼zerine Ã§alÄ±ÅŸÄ±yorum.</p>

            

            <h2>ðŸ›  Yeteneklerim</h2>

            <div class="grid">

                <div class="card">

                    <h3>YazÄ±lÄ±m & Oyun</h3>

                    <div style="margin-top:15px;">

                        <div class="skill-bar"><div class="skill-info"><span>C / C++ (Embedded)</span><span>90%</span></div><div class="progress-bg"><div class="progress" style="width: 90%"></div></div></div>

                        <div class="skill-bar"><div class="skill-info"><span>Verilog / VHDL</span><span>75%</span></div><div class="progress-bg"><div class="progress" style="width: 75%"></div></div></div>

                        <div class="skill-bar"><div class="skill-info"><span>Lua / Unity</span><span>60%</span></div><div class="progress-bg"><div class="progress" style="width: 60%"></div></div></div>

                    </div>

                </div>

                <div class="card">

                    <h3>DonanÄ±m & Kartlar</h3>

                    <div class="tech-stack" style="margin-top:15px;">

                        <span class="tech-tag">Tang Nano 9K</span>

                        <span class="tech-tag">Gatemate CCGM1A1</span>

                        <span class="tech-tag">STM32</span>

                        <span class="tech-tag">RPi Pico</span>

                        <span class="tech-tag">Arduino Uno</span>

                        <span class="tech-tag">ESP32</span>

                    </div>

                </div>

            </div>

        </section>



        <section id="projects">

            <h1>TÃ¼m Projelerim</h1>

            <div id="repos-container" class="grid">

                <div class="loading-text">GitHub'dan veriler Ã§ekiliyor...</div>

            </div>

        </section>



        <section id="games">

            <h1>Mini Arcade</h1>

            <div class="game-container-split">

                <div class="game-list">

                    <div class="card game-card" onclick="startGame('snake', this)">

                        <h3><i class="fas fa-worm"></i> Cyber Snake</h3>

                    </div>

                    <div class="card game-card" onclick="startGame('tetris', this)">

                        <h3><i class="fas fa-cubes"></i> Neon Blocks</h3>

                    </div>

                    <div class="card game-card" onclick="startGame('maze', this)">

                        <h3><i class="fas fa-ghost"></i> Maze Chase</h3>

                    </div>

                </div>

                <div class="game-stage">

                    <div id="scoreBoard" class="score-board">SKOR: 0</div>

                    <canvas id="gameCanvas" width="400" height="400"></canvas>

                    <div id="gameControls" class="game-controls">Oynamak iÃ§in bir oyun seÃ§in</div>

                </div>

            </div>

        </section>



        <section id="iot">

            <h1>ðŸ¤– Robotik Kodlama LaboratuvarÄ±</h1>

            <p>Ä°ster C++ kodu yazÄ±p yÃ¼kleyin, ister bloklarla kontrol edin.</p>

            

            <div class="card" style="border-top: 4px solid #00bcd4; margin-bottom: 20px;">

                <div class="card-header" style="border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 10px;">

                    <h3><i class="fas fa-code"></i> C++ Kod EditÃ¶rÃ¼</h3>

                </div>



                <div style="position: relative;">

                    <textarea id="cppEditor" style="width: 100%; height: 200px; background: #111; color: #0f0; border: 1px solid #444; padding: 10px; font-family: 'Consolas', monospace; border-radius: 4px; resize: vertical;">

void setup() {

  pinMode(13, OUTPUT);

}



void loop() {

  digitalWrite(13, HIGH);

  delay(100);

  digitalWrite(13, LOW);

  delay(100);

}

                    </textarea>

                    <div id="statusLabelNew" style="margin-top: 5px; font-size: 0.9rem; color: #888;">Durum: Bekleniyor...</div>

                </div>



                <div class="header-controls" style="justify-content: flex-start; margin-top: 15px;">

                    <button id="btnCompileNew" class="serial-btn" style="background:#00bcd4; color:black;" onclick="compileCode()">

                        <i class="fas fa-cog"></i> 1. Derle (Server)

                    </button>

                    

                    <button id="btnUploadNew" class="serial-btn off" style="background:#555; color:white; cursor: not-allowed;" disabled onclick="runUploader()">

                        <i class="fas fa-upload"></i> 2. Kodu YÃ¼kle

                    </button>

                </div>

            </div>



            <div class="card" style="border-top: 4px solid var(--primary);">

                <div class="card-header" style="border-bottom: 1px solid #333; padding-bottom: 15px; margin-bottom: 0;">

                    <div style="display:flex; align-items:center; gap:10px;">

                        <h3><i class="fas fa-cubes"></i> Blok StÃ¼dyosu & Kontrol</h3>

                        <span id="statusBadge" class="status-badge"><i class="fas fa-circle" style="font-size:0.6rem;"></i> BaÄŸlantÄ± Yok</span>

                    </div>

                    

                    <div class="header-controls">

                        <button id="btnQuickTest" class="serial-btn" style="background:#7000ff; color:white;" onclick="runQuickTest()">

                            <i class="fas fa-microchip"></i> Test Firmware YÃ¼kle

                        </button>

                        

                        <button id="btnConnect" class="serial-btn connect" onclick="connectSerial()">

                            <i class="fas fa-plug"></i> BaÄŸlan (Bloklar Ä°Ã§in)

                        </button>

                        <button id="btnDisconnect" class="serial-btn off" onclick="disconnectSerial()" style="display:none; background:#ff0055; color:white;">

                            <i class="fas fa-power-off"></i> Kes

                        </button>

                    </div>

                </div>



                <div class="iot-panel">

                    

                    <div class="block-list">

                        <div class="code-block" style="background: linear-gradient(90deg, #4C97FF, #2D7DE0);">

                            <i class="fas fa-lightbulb"></i>

                            <span>Pin</span>

                            <select id="pinSelectOn" class="block-input"><option value="13">13</option><option value="12">12</option><option value="11">11</option></select>

                            <span>LED'ini</span> <strong>YAK</strong>

                            <button class="run-btn" onclick="runBlock('ON')"><i class="fas fa-play"></i></button>

                        </div>



                        <div class="code-block" style="background: linear-gradient(90deg, #FF6680, #E02D4C);">

                            <i class="far fa-lightbulb"></i>

                            <span>Pin</span>

                            <select id="pinSelectOff" class="block-input"><option value="13">13</option><option value="12">12</option><option value="11">11</option></select>

                            <span>LED'ini</span> <strong>SÃ–NDÃœR</strong>

                            <button class="run-btn" onclick="runBlock('OFF')"><i class="fas fa-play"></i></button>

                        </div>

                    </div>



                    <div class="console-wrapper">

                        <div class="console-header"><span><i class="fas fa-terminal"></i> Seri Port Konsolu</span><span style="font-size:0.7rem; opacity:0.7;">115200 Baud</span></div>

                        <div id="serialConsole" class="serial-console">

                            > Sistem hazÄ±r.<br>> Kod yazÄ±p yÃ¼kleyebilir veya "BaÄŸlan" diyerek bloklarÄ± kullanabilirsiniz.

                        </div>

                    </div>



                </div>

            </div>

        </section>



    </main>

    

    <script src="script.js"></script>



    <script>

    // --- GLOBAL DEÄžÄ°ÅžKENLER ---

    let compiledHexCode = null; // Derlenen kod

    let serialPort = null;      // AÃ§Ä±k port

    let serialWriter = null;    // Veri gÃ¶nderme aracÄ±



    // ============================================================

    // 1. BÃ–LÃœM: DERLEME VE YÃœKLEME (Backend)

    // ============================================================

    async function compileCode() {

        const editorVal = document.getElementById('cppEditor').value;

        const statusLbl = document.getElementById('statusLabelNew');

        const btnUpload = document.getElementById('btnUploadNew');



        statusLbl.innerText = "Durum: Sunucuda derleniyor... (Bekleyin)";

        statusLbl.style.color = "#40c4ff";



        try {

            const response = await fetch('https://arduino-backend-ajkr.onrender.com/compile', {

                method: 'POST',

                headers: { 'Content-Type': 'application/json' },

                body: JSON.stringify({ code: editorVal })

            });



            if (!response.ok) throw new Error("Sunucu HatasÄ±");

            const data = await response.json();



            if (data.hex) {

                compiledHexCode = data.hex;

                statusLbl.innerText = "Durum: BAÅžARILI! Kodu yÃ¼kleyebilirsiniz.";

                statusLbl.style.color = "#00e676";

                btnUpload.disabled = false;

                btnUpload.style.background = "#ff9800";

                btnUpload.style.cursor = "pointer";

                btnUpload.classList.remove('off');

            } else {

                throw new Error("Hex kodu boÅŸ dÃ¶ndÃ¼.");

            }

        } catch (err) {

            console.error(err);

            statusLbl.innerText = "Hata: " + err.message;

            statusLbl.style.color = "#ff5252";

        }

    }



    async function runUploader(hexDataToUse = null) {

        // EÄŸer fonksiyona Ã¶zel hex verilmediyse, derlenmiÅŸ olanÄ± kullan

        const hexToFlash = hexDataToUse || compiledHexCode;



        if (!hexToFlash) {

            alert("Ã–nce kodu derlemelisiniz veya Test Firmware YÃ¼klemeyi denemelisiniz!");

            return;

        }

        

        // EÄŸer port aÃ§Ä±ksa kapatmayÄ± dene (Ã‡akÄ±ÅŸmayÄ± Ã¶nlemek iÃ§in)

        if (serialPort) {

            try { await serialPort.close(); serialPort = null; } catch(e){}

        }



        const statusLbl = document.getElementById('statusLabelNew') || document.getElementById('statusBadge');

        if(statusLbl) statusLbl.innerText = "Port SeÃ§iliyor...";



        try {

            await navigator.serial.requestPort(); // Port izni iste

            

            const blob = new Blob([hexToFlash], { type: 'application/octet-stream' });

            const reader = new FileReader();



            reader.onload = function(event) {

                const fileBuffer = event.target.result;

                const avrgirl = new AvrgirlArduino({ board: 'uno', debug: true });



                avrgirl.flash(fileBuffer, (error) => {

                    if (error) {

                        alert("YÃ¼kleme HatasÄ±: " + error.message);

                    } else {

                        alert("BAÅžARILI! Kod YÃ¼klendi. Åžimdi 'BaÄŸlan' diyip kontrol edebilirsiniz.");

                        // YÃ¼kleme bitince statusu gÃ¼ncelle

                        const badge = document.getElementById('statusBadge');

                        if(badge) badge.innerHTML = '<i class="fas fa-check"></i> YÃ¼klendi';

                        

                        // YÃ¼kleme tamamlandÄ±ÄŸÄ±nda Test butonu kilitli kalmasÄ±n

                        const testBtn = document.getElementById('btnQuickTest');

                        if(testBtn && testBtn.disabled) {

                            testBtn.disabled = false;

                            testBtn.innerHTML = '<i class="fas fa-microchip"></i> Test Firmware YÃ¼kle';

                        }

                    }

                });

            };

            reader.readAsArrayBuffer(blob);

        } catch (err) {

            alert("Ä°ÅŸlem Ä°ptal Edildi: " + err);

            // Ä°ptal durumunda Test butonunu dÃ¼zelt

            const testBtn = document.getElementById('btnQuickTest');

            if(testBtn) {

                testBtn.disabled = false;

                testBtn.innerHTML = '<i class="fas fa-microchip"></i> Test Firmware YÃ¼kle';

            }

        }

    }



    // ============================================================

    // 2. BÃ–LÃœM: TEST FÄ°RMWARE YÃœKLEME (FÄ°RMWARE.HEX OKUMA)

    // ============================================================

    async function runQuickTest() {

        const btn = document.getElementById('btnQuickTest');

        const statusLbl = document.getElementById('statusBadge');



        // 1. Butonun durumunu gÃ¼ncelle (YÃ¼kleniyor efekti)

        if(btn) {

            btn.disabled = true;

            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ä°ndiriliyor...';

        }

        if(statusLbl) statusLbl.innerHTML = '<span style="color:orange">Dosya okunuyor...</span>';



        try {

            // 2. firmware.hex dosyasÄ±nÄ± sunucudan/klasÃ¶rden metin olarak Ã§ek

            // (firmware.hex dosyasÄ± index.html ile aynÄ± klasÃ¶rde olmalÄ±)

            const response = await fetch('firmware.hex');

            

            if (!response.ok) {

                throw new Error("firmware.hex dosyasÄ± bulunamadÄ±! (HTTP " + response.status + ")");

            }

            

            // Hex dosyasÄ±nÄ±n iÃ§eriÄŸini metin (string) olarak al

            const hexText = await response.text();



            // 3. Mevcut yÃ¼kleyici fonksiyonuna bu metni gÃ¶nder

            if(btn) btn.innerHTML = '<i class="fas fa-microchip"></i> YÃ¼kleniyor...';

            

            // runUploader'Ä± Ã§aÄŸÄ±r ve hex verisini iÃ§ine at

            await runUploader(hexText);



        } catch (err) {

            console.error(err);

            alert("Hata oluÅŸtu: " + err.message);

            if(statusLbl) statusLbl.innerHTML = '<span style="color:red">Hata!</span>';

            // Hata durumunda butonu hemen aÃ§

            if(btn) {

                btn.disabled = false;

                btn.innerHTML = '<i class="fas fa-microchip"></i> Test Firmware YÃ¼kle';

            }

        }

    }



    // ============================================================

    // 3. BÃ–LÃœM: SERÄ° PORT BAÄžLANTISI VE KONTROL (CanlÄ± EtkileÅŸim)

    // ============================================================

    

    async function connectSerial() {

        if (!navigator.serial) {

            alert("TarayÄ±cÄ±nÄ±z Seri Port desteklemiyor. Chrome veya Edge kullanÄ±n.");

            return;

        }



        try {

            // 1. Port Ä°ste

            serialPort = await navigator.serial.requestPort();

            

            // 2. Portu AÃ§ (Arduino standart hÄ±zÄ± 115200 veya 9600 olabilir, biz 115200 kullanacaÄŸÄ±z)

            await serialPort.open({ baudRate: 115200 });



            // 3. YazÄ±cÄ±yÄ± (Writer) HazÄ±rla

            const textEncoder = new TextEncoderStream();

            const writableStreamClosed = textEncoder.readable.pipeTo(serialPort.writable);

            serialWriter = textEncoder.writable.getWriter();



            // 4. ArayÃ¼zÃ¼ GÃ¼ncelle

            const badge = document.getElementById('statusBadge');

            badge.innerHTML = '<i class="fas fa-circle" style="color:#00e676; font-size:0.6rem;"></i> BaÄŸlandÄ±';

            badge.style.color = "#00e676";

            

            // Konsola yaz

            document.getElementById('serialConsole').innerHTML += "<br>> <span style='color:#0f0'>BaÄŸlantÄ± BaÅŸarÄ±lÄ±!</span> ButonlarÄ± kullanabilirsiniz.";



        } catch (err) {

            console.error(err);

            alert("BaÄŸlantÄ± HatasÄ±: " + err);

        }

    }



    // Butonlara basÄ±lÄ±nca Ã§alÄ±ÅŸan fonksiyon

    async function runBlock(command) {

        if (!serialWriter) {

            alert("Ã–nce 'BaÄŸlan' butonuna basarak baÄŸlantÄ±yÄ± kurmalÄ±sÄ±nÄ±z!");

            return;

        }



        try {

            // Arduino'ya tek karakterlik komut gÃ¶nderiyoruz

            // '1' -> Yak

            // '0' -> SÃ¶ndÃ¼r

            let charToSend = "";

            

            if (command === 'ON') charToSend = "1";

            if (command === 'OFF') charToSend = "0";

            

            await serialWriter.write(charToSend);

            

            // Konsola Log DÃ¼ÅŸ

            document.getElementById('serialConsole').innerHTML += `<br>> Komut GÃ¶nderildi: ${command}`;

            

        } catch (err) {

            alert("GÃ¶nderme HatasÄ±: " + err);

        }

    }

</script>

</body>

</html>

